
# 从NoSQL到Lakehouse，Apache Doris的13年技术演进之路【阅读随笔】

## 原文链接

[从NoSQL到Lakehouse，Apache Doris的13年技术演进之路](https://www.infoq.cn/article/fC5eYoevUrEKVMBiGHwF)

## 阅读随笔

### 先废话几句

前一阵翻了一篇对LakeHouse介绍的文章，当时还在感慨在数仓领域的模型也演进的是真快，很快就看到Doris也在朝着方向在发展了，这篇文章来自于对Doris作者的一个访谈，里面涵盖了两部分，一部分是在讲Doris的演进，一部分是在讲开源方面的内容，有很多比较值得思考和深思的东西，从作者的观点能够完整的看到Doris设计的需求、产品演进思路，很值得撸一撸。

翻到了那篇Lakehouse的链接：[LakeHouse](https://databricks.com/blog/2020/01/30/what-is-a-data-lakehouse.html)

懒得看上面的链接你也可以一图撸完Lakehouse的介绍![我是图](https://databricks.com/wp-content/uploads/2020/01/data-lakehouse-new.png)

### Doris部分

#### Doris的演进阶段

    NoSQL => NewSQL => LakeHouse

#### Doris的当前目标

+ 拥抱云原生
+ 支持半结构化数据
+ 把原来Doris最擅长的在线结构化MPP数据分析性能优化到最快，而导入实时化、存储读写性能优化、计算性能优化，这些会学习和借鉴ClickHouse的一些设计

#### Doris解决用户的三大需求

1. 50%的需求依旧是各类报表和数据分析可视化需求，BI需求；
2. 20-30%的需求，是对日志等半结构化数据的搜索分析需求；
3. 20-30%的需求，是对数据科学与机器学习的需求；

#### Doris在OALP的优势

+ 运维性好
  + 成本节省，分层存储，可以自动后台SSD => SATA
  + 手动添加，减少自动添加风险(PS：仁者见仁)
  + 保障物化视图与基础表数据的一致性

+ 缺点
  + 对传统数仓的SQL兼容
  + 云原生适配差，原有模型主要针对私有化部署

#### 性能不是唯一关注点

+ 没有clickhouse快
  + 为了保障有其他资源处理并发
  + 更多的发力易用性和可运维性，比如为了不引入多余组件，例如zk，会自己设计多个FE
  + 后续会支持双模式，在新模式下会使用全部资源计算(PS：妥协了)

#### 主要的功能增加

+ 流式导入功能帮助Doris从分钟甚至小时级别的导入延迟推进到了秒级，更好地支撑了准实时的业务需求
+ 完全重构了存储引擎，提升扩展性的同时，支持了包括二级索引、字典压缩编码在内的多项实用功能
+ 进行了大量的大数据生态打通工作，包括Spark、Flink、ES、Hive、Kafka的直接连通，使得Doris不再成为数据孤岛
+ 在明细数据上扩展了预聚合模型，完成了明细、聚合模型的数据统一访问
+ 全新的向量化执行引擎和资源隔离方案也即将发布，将进一步提升Doris的数据分析性能和业务应用场景
+ 还有其他非常多的稳定性和易用性的提升，也是得益于开源后社区用户的不断打磨和反馈

#### Doris与Data Lake

    Doris偏在线，存算一体，数据湖存算分离(例：HDSF/对象存储+spark/hive/presto)
    未来，Data Warehouse与Data Lake的融合架构 => Lakehouse

#### 周边生态

+ SQL笑到最后，80%以上，Mp、Pig、Pyspark都不太行
+ 实时才是最终追求
+ 云原生是趋势

### 开源

#### 基础架构开源

***只有开源才能保持活力和持续迭代，像Doris这种基础软件，需要较大投入，如果不开源，不寻找其它价值点，是很难让一个大公司持续投入资源来维持其不断发展的。(这段话受益匪浅，但是想达到这个目标，开源的质量是关键)***

#### 什么样的软件算开源成功

+ 被广泛认可的产品价值
+ 繁荣、自治、良性发展的社区生态
+ 开源与商业化的平衡与共存

#### 商业化与开源的冲突

    不冲突，商业市场的2/8原则，20%的付费用户提供80%的收入，但是20%的付费用户的选择参考自80%非付费用户，相辅相成
